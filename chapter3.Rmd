# Logistic regression

Load libraries

```{r}

library(tidyr)
library(dplyr)
library(ggplot2)

```

1. Read the data from local folder and check for structure and dimensions

```{r}
data2020 <- read.table("C:/LocalData/kpuukko/IODS-project/data/alc.txt", sep="\t")

#There are 382 observations and 35 variables in the dataset
str(data2020)
dim(data2020)
colnames(data2020) #198 Female and 184 Male students

# Age distribution is from 15 to 22 years old, most of the students are 16 or 17 years old. 
data2020 %>% group_by(age) %>% summarise(count = n())

#Draw a bar plot of each variable
gather(data2020) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()

```
2. I will study the relationship between gender, school absenses, going out, famrel and alcohol consumption

Hypothesis

H1: Higher quality of family relationships reduce the risk for high alcohol consumption. 
H2: School absenses are positively related to high alcohol consumption. 
H3: Going out increases the risk for high alcohol consumption.
H4: Men consume alcohol more than women. 

3. Numerically and graphically explore the distributions of your chosen variables and their relationships with alcohol consumption (use for example cross-tabulations, bar plots and box plots). Comment on your findings and compare the results of your exploration to your previously stated hypotheses. (0-5 points)

```{r}
# A box plot of high_use and family relationship
#As assumed, students who are high alcohol users have lower quality family relationships. 
g1 <- ggplot(data2020, aes(x = high_use, y = famrel))
g1 + geom_boxplot() + ylab("Family relationship")

# A box plot of high_use and school absenses
#Students who consume more alcohol have slightly more school absenses compared to students who are not high users. However, the differences between the groups appears really small. 
g2 <- ggplot(data2020, aes(x = high_use, y = absences))
g2 + geom_boxplot() + ylab("School absenses")

# A box plot of high_use and going out
#As assumed, students who are high alcohol users go out more than other students.  
g3 <- ggplot(data2020, aes(x = high_use, y = goout))
g3 + geom_boxplot() + ylab("Going out")

# A box plot of alcohol use and going out
#As assumed, men use alcohol more than women.  
g4 <- ggplot(data2020, aes(x = sex, y = alc_use))
g4 + geom_boxplot() + ylab("Alcohol use")
```
4. Logistic regression analysis with family relationships, absences, going out and gender as predictors and high alcohol consumption as an outcome 

```{r}

Mod1 <- glm(high_use ~ famrel + absences + goout + sex, data = data2020, family = "binomial")
summary(Mod1)

```
5. Explore the predictive power of you model. Provide a 2x2 cross tabulation of predictions versus the actual values and optionally display a graphic visualizing both the actual values and the predictions. Compute the total proportion of inaccurately classified individuals (= the training error) and comment on all the results. 

```{r}

```
 
